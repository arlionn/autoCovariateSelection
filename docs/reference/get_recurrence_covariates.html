<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Generate the binary recurrence covariates for the identified candidate empirical covariates — get_recurrence_covariates • autoCovariateSelection</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Generate the binary recurrence covariates for the identified candidate empirical covariates — get_recurrence_covariates" />
<meta property="og:description" content="get_recurrence_covariates function assesses the recurrence of each of the identified candidate empirical covariates
based on their frequency of occurrence for each patient in the baseline period and generates three binary recurrence covariates
for each of the identified candidate empirical covariates. This is the second step in the automated covariate selection process.
The first step of identifying empirical candidate covariates is done via get_candidate_covariates function.
See 'Automated Covariate Selection'section below for more details regarding the overall process." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">autoCovariateSelection</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/technOslerphile/autoCovariateSelection/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generate the binary recurrence covariates for the identified candidate empirical covariates</h1>
    <small class="dont-index">Source: <a href='https://github.com/technOslerphile/autoCovariateSelection/blob/master/R/acs.R'><code>R/acs.R</code></a></small>
    <div class="hidden name"><code>get_recurrence_covariates.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>get_recurrence_covariates</code> function assesses the recurrence of each of the identified candidate empirical covariates
based on their frequency of occurrence for each patient in the baseline period and generates three binary recurrence covariates
for each of the identified candidate empirical covariates. This is the second step in the automated covariate selection process.
The first step of identifying empirical candidate covariates is done via <code><a href='get_candidate_covariates.html'>get_candidate_covariates</a></code> function.
See 'Automated Covariate Selection'section below for more details regarding the overall process.</p>
    </div>

    <pre class="usage"><span class='fu'>get_recurrence_covariates</span><span class='op'>(</span>
  <span class='va'>df</span>,
  <span class='va'>patientIdVarname</span>,
  <span class='va'>eventCodeVarname</span>,
  <span class='va'>patientIdVector</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>df</th>
      <td><p>The input <code>data.frame</code>. Ideally this should be the output <code>covars_data</code>
from <code><a href='get_candidate_covariates.html'>get_candidate_covariates</a></code></p></td>
    </tr>
    <tr>
      <th>patientIdVarname</th>
      <td><p>The variable name which contains the patient identifier in the <code>df</code></p></td>
    </tr>
    <tr>
      <th>eventCodeVarname</th>
      <td><p>The variable name which contains the covariate codes (eg:- CCS, ICD9) in the <code>df</code></p></td>
    </tr>
    <tr>
      <th>patientIdVector</th>
      <td><p>The 1-D vector with all the patient identifiers. This should contain all the patient IDs in the original two
cohorts. This vector can simply be the <code>patientIds</code> output vector of the <code>get_candidate_covariates</code> function.
of the function</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A named list containing two R objects</p><ul>
<li><p><code>recurrence_data</code>   A <code>data.frame</code> containing all the binary recurrence covariates for all the patients in wide format.
This means that this <code>data.frame</code> will have a dimension with number of rows equal to number of distinct patients and number of
columns equal to number of binary recurrence covariates plus 1 (for the patient Id variable). The binary recurrence covariate is prefixed with
a 'rec_' to indicate that the covariate is a 'reccurrence covariate' and suffixed with '_once', '_sporadic' or '_frequent'.
See <code>details</code> section above for details.</p></li>
<li><p><code>patientIds</code>   The list of patient ids present in the original input <code>df</code>. This is exactly the same as the input <code>patientIdVector</code></p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The recurrence covariates are generated based on the frequency (counts) of occurrence of each empirical candidate covariates that got
generated by the <code>generate_candidate_covariates</code> function. This is done by looking at the baseline period of each patients and
assessing whether the covariate occurred only once or sporadically or frequently. That is, a maximum of three recurrence covariates
for each candidate covariate is created and returned.</p><ul>
<li><p><code>once</code> Indicates whether or not the covariate occurred more than or equal to 1 number of times for the patient</p></li>
<li><p><code>sporadic</code> Indicates whether or not the covariate occurred more than or equal to median (median of non-zero occurrences of
the candidate covariate) number of times for the patient.</p></li>
<li><p><code>frequent</code> Indicates whether or not the covariate occurred more than or equal to upper quartile (75th percentile of non-zero
occurrences of the candidate covariate) number of times for the patient</p></li>
</ul><p>Note that if two or all three covariates are identical for any of the binary recurrence covariates, only the distinct recurrence covariate
is returned. For example, if once == sporadic == frequent for the candidate covariate (median and upper quartile both are 1), then only the 'once' recurrence covariate is
returned. If once != sporadic == frequent, then 'once' and 'sporadic' is returned. If once == sporadic != frequent, then 'once'
and 'frequent' are returned. If none of three recurrence covariates are identical, then all three are returned.
The theoretical details of the algorithm implemented is detailed in the publication listed below in the <code>References</code> section.
<code>get_recurrence_covariates</code> is the function implementing what is described in the 'Assess Recurrence' section
of the article.</p>
    <h2 class="hasAnchor" id="automated-covariate-selection"><a class="anchor" href="#automated-covariate-selection"></a>Automated Covariate Selection</h2>

    

<p><strong>The three steps in automated covariate selection are listed below with the functions implementing the methodology</strong></p><ol>
<li><p>Identify candidate empirical covariates: <code><a href='get_candidate_covariates.html'>get_candidate_covariates</a></code></p></li>
<li><p>Assess recurrence: <code>get_recurrence_covariates</code></p></li>
<li><p>Prioritize covariates: <code><a href='get_prioritised_covariates.html'>get_prioritised_covariates</a></code></p></li>
</ol>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Schneeweiss S, Rassen JA, Glynn RJ, Avorn J, Mogun H, Brookhart MA. High-dimensional propensity score adjustment in studies of treatment effects using health care claims data Epidemiology. 2009;20(4):512-522. doi:10.1097/EDE.0b013e3181a663cc</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Dennis Robert <a href='mailto:dennis.robert.nm@gmail.com'>dennis.robert.nm@gmail.com</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://github.com/technOslerphile/autoCovariateSelection'>"autoCovariateSelection"</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>rwd</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>rwd</span>, <span class='fl'>3</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   person_id index_date event_date event_code event_concept_id domain treatment
#&gt; 1     21047 2010-06-10 2010-02-21      78650         44825809     dx         1
#&gt; 2     21047 2010-06-10 2010-03-01       2449         44828786     dx         1
#&gt; 3     21047 2010-06-10 2010-01-19      25002         44836915     dx         1
#&gt;   outcome_date last_enrollment_date
#&gt; 1         &lt;NA&gt;           2011-01-01
#&gt; 2         &lt;NA&gt;           2011-01-01
#&gt; 3         &lt;NA&gt;           2011-01-01</div><div class='input'><span class='va'>basetable</span> <span class='op'>&lt;-</span> <span class='va'>rwd</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='va'>person_id</span>, <span class='va'>treatment</span>, <span class='va'>outcome_date</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>distinct</span><span class='op'>(</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>basetable</span>, <span class='fl'>3</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   person_id treatment outcome_date
#&gt; 1     21047         1         &lt;NA&gt;
#&gt; 2    378287         1         &lt;NA&gt;
#&gt; 3    320862         1         &lt;NA&gt;</div><div class='input'><span class='va'>patientIds</span> <span class='op'>&lt;-</span> <span class='va'>basetable</span><span class='op'>$</span><span class='va'>person_id</span>
<span class='va'>step1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='get_candidate_covariates.html'>get_candidate_covariates</a></span><span class='op'>(</span>df <span class='op'>=</span> <span class='va'>rwd</span>,  domainVarname <span class='op'>=</span> <span class='st'>"domain"</span>,
eventCodeVarname <span class='op'>=</span> <span class='st'>"event_code"</span> , patientIdVarname <span class='op'>=</span> <span class='st'>"person_id"</span>,
patientIdVector <span class='op'>=</span> <span class='va'>patientIds</span>,n <span class='op'>=</span> <span class='fl'>100</span>, min_num_patients <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Joining, by = c("eventCodeVarname", "domainVarname")</span></div><div class='input'><span class='va'>out1</span> <span class='op'>&lt;-</span> <span class='va'>step1</span><span class='op'>$</span><span class='va'>covars_data</span>
<span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>patientIds</span>, <span class='va'>step1</span><span class='op'>$</span><span class='va'>patientIds</span><span class='op'>)</span> <span class='co'>#should return  TRUE</span>
</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'><span class='va'>step2</span> <span class='op'>&lt;-</span> <span class='fu'>get_recurrence_covariates</span><span class='op'>(</span>df <span class='op'>=</span> <span class='va'>out1</span>, patientIdVarname <span class='op'>=</span> <span class='st'>"person_id"</span>,
eventCodeVarname <span class='op'>=</span> <span class='st'>"event_code"</span>, patientIdVector <span class='op'>=</span> <span class='va'>patientIds</span><span class='op'>)</span>
<span class='va'>out2</span> <span class='op'>&lt;-</span> <span class='va'>step2</span><span class='op'>$</span><span class='va'>recurrence_data</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Dennis Robert.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


