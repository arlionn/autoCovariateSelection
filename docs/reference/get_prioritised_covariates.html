<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Generate the prioritised covariates from the global list of binary recurrence covariates using multiplicative bias ranking — get_prioritised_covariates • autoCovariateSelection</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Generate the prioritised covariates from the global list of binary recurrence covariates using multiplicative bias ranking — get_prioritised_covariates" />
<meta property="og:description" content="get_prioritised_covariates function assesses the recurrence of each of the identified candidate empirical covariates
based on their frequency of occurrence for each patient in the baseline period and generates three binary recurrence covariates
for each of the identified candidate empirical covariates. This is the third and final step in the automated covariate selection process.
The previous step of assessing recurrence and generating the binary recurrence covariates is done
using the get_recurrence_covariates function.
See 'Automated Covariate Selection'section below for more details regarding the overall process." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">autoCovariateSelection</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/technOslerphile/autoCovariateSelection/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generate the prioritised covariates from the global list of binary recurrence covariates using multiplicative bias ranking</h1>
    <small class="dont-index">Source: <a href='https://github.com/technOslerphile/autoCovariateSelection/blob/master/R/acs.R'><code>R/acs.R</code></a></small>
    <div class="hidden name"><code>get_prioritised_covariates.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>get_prioritised_covariates</code> function assesses the recurrence of each of the identified candidate empirical covariates
based on their frequency of occurrence for each patient in the baseline period and generates three binary recurrence covariates
for each of the identified candidate empirical covariates. This is the third and final step in the automated covariate selection process.
The previous step of assessing recurrence and generating the binary recurrence covariates is done
using the <code><a href='get_recurrence_covariates.html'>get_recurrence_covariates</a></code> function.
See 'Automated Covariate Selection'section below for more details regarding the overall process.</p>
    </div>

    <pre class="usage"><span class='fu'>get_prioritised_covariates</span><span class='op'>(</span>
  <span class='va'>df</span>,
  <span class='va'>patientIdVarname</span>,
  <span class='va'>exposureVector</span>,
  <span class='va'>outcomeVector</span>,
  <span class='va'>patientIdVector</span>,
  k <span class='op'>=</span> <span class='fl'>500</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>df</th>
      <td><p>The input <code>data.frame</code>. Ideally this should be the output <code>recurrence_data</code> from the
<code><a href='get_recurrence_covariates.html'>get_recurrence_covariates</a></code> function</p></td>
    </tr>
    <tr>
      <th>patientIdVarname</th>
      <td><p>The variable name which contains the patient identifier in the <code>df</code></p></td>
    </tr>
    <tr>
      <th>exposureVector</th>
      <td><p>The 1-D exposure (treatment/intervention) vector. The length of this vector should be equal to that of
<code>patientIdVector</code> and <code>outcomeVector</code>. Also, this should be a binary vector with value of 1 for patients primary cohort 1 and 0 for
those in comparator cohort. The order of this vector should resonate the order of patients in <code>outcomeVector</code> and <code>patientIdVector</code></p></td>
    </tr>
    <tr>
      <th>outcomeVector</th>
      <td><p>The 1-D outcome vector indicating whether or not the patient experienced the outcome of interest (value = 1) or not (value =0).
The length of this vector should be equal to that of <code>patientIdVector</code> and <code>exposureVector</code>. The order of elements in this vector should
resonate with the order of patients in <code>exposureVector</code> and <code>patientIdVector</code></p></td>
    </tr>
    <tr>
      <th>patientIdVector</th>
      <td><p>The 1-D vector with all the patient identifiers. This should contain all the patient IDs in the original two
cohorts with its length and order equal to and resonating with that of <code>exposureVector</code> and <code>outcomeVector</code></p></td>
    </tr>
    <tr>
      <th>k</th>
      <td><p>The maximum number of prioritised covariates that should be returned by the function. By default, this is 500 as described in the original paper</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A named list containing two R objects</p><ul>
<li><p><code>autoselected_covariate_df</code> A <code>data.frame</code> in wide format containing the auto-selected prioritised covariates and their values (1 or 0)
for each patients</p></li>
<li><p><code>multiplicative_bias</code>The absolute log of the multiplicative bias term for each of the auto-selected prioritised covariates</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>To prioritise covariates across data dimensions (domains) should be assessed by their potential for controlling confounding that is not conditional
on exposure and other covariates. This means that the association of the covariates with the outcomes (relative risk) should be taken into
consideration for quantifying the 'potential' for confounding. Relative risk weighted by the ratio of prevalence of the covariates between the
two exposure groups is known as multiplicative bias. The other way to do this would be to use the absolute risk and this would have been the rather
straight-forward procedure to quantify the potential for confounding. However, this method would invariably down-weight the association between the
covariate and the outcome if the outcome prevalence is small and the exposure prevalence is high which is a common phenomenon seen with comparative
effective research using real-world-data by retrospective cohort studies. The multiplicative bias term balances this and generates a quantity for each
covariate that is reflective of its confounding potential. By ranking the multiplicative bias, the objective is to choose the top <code>k</code> number of
covariates from this procedure. <code>k</code>, by default, is 500 as described in the original paper. For further theoretical details of the
algorithm please refer to the original article listed below in the <code>References</code> section. <code>get_recurrence_covariates</code> is the function
implementing what is described in the 'Prioritise Covariates' section of the article.</p>
    <h2 class="hasAnchor" id="automated-covariate-selection"><a class="anchor" href="#automated-covariate-selection"></a>Automated Covariate Selection</h2>

    

<p><strong>The three steps in automated covariate selection are listed below with the functions implementing the methodology</strong></p><ol>
<li><p>Identify candidate empirical covariates: <code><a href='get_candidate_covariates.html'>get_candidate_covariates</a></code></p></li>
<li><p>Assess recurrence: <code><a href='get_recurrence_covariates.html'>get_recurrence_covariates</a></code></p></li>
<li><p>Prioritize covariates: <code>get_prioritised_covariates</code></p></li>
</ol>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Schneeweiss S, Rassen JA, Glynn RJ, Avorn J, Mogun H, Brookhart MA. High-dimensional propensity score adjustment in studies of treatment effects using health care claims data Epidemiology. 2009;20(4):512-522. doi:10.1097/EDE.0b013e3181a663cc</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Dennis Robert <a href='mailto:dennis.robert.nm@gmail.com'>dennis.robert.nm@gmail.com</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='st'><a href='https://github.com/technOslerphile/autoCovariateSelection'>"autoCovariateSelection"</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>rwd</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>rwd</span>, <span class='fl'>3</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   person_id index_date event_date event_code event_concept_id domain treatment
#&gt; 1     21047 2010-06-10 2010-02-21      78650         44825809     dx         1
#&gt; 2     21047 2010-06-10 2010-03-01       2449         44828786     dx         1
#&gt; 3     21047 2010-06-10 2010-01-19      25002         44836915     dx         1
#&gt;   outcome_date last_enrollment_date
#&gt; 1         &lt;NA&gt;           2011-01-01
#&gt; 2         &lt;NA&gt;           2011-01-01
#&gt; 3         &lt;NA&gt;           2011-01-01</div><div class='input'><span class='va'>basetable</span> <span class='op'>&lt;-</span> <span class='va'>rwd</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='va'>person_id</span>, <span class='va'>treatment</span>, <span class='va'>outcome_date</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>distinct</span><span class='op'>(</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>basetable</span>, <span class='fl'>3</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   person_id treatment outcome_date
#&gt; 1     21047         1         &lt;NA&gt;
#&gt; 2    378287         1         &lt;NA&gt;
#&gt; 3    320862         1         &lt;NA&gt;</div><div class='input'><span class='va'>patientIds</span> <span class='op'>&lt;-</span> <span class='va'>basetable</span><span class='op'>$</span><span class='va'>person_id</span>
<span class='va'>step1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='get_candidate_covariates.html'>get_candidate_covariates</a></span><span class='op'>(</span>df <span class='op'>=</span> <span class='va'>rwd</span>,  domainVarname <span class='op'>=</span> <span class='st'>"domain"</span>,
eventCodeVarname <span class='op'>=</span> <span class='st'>"event_code"</span> , patientIdVarname <span class='op'>=</span> <span class='st'>"person_id"</span>,
patientIdVector <span class='op'>=</span> <span class='va'>patientIds</span>,n <span class='op'>=</span> <span class='fl'>100</span>, min_num_patients <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Joining, by = c("eventCodeVarname", "domainVarname")</span></div><div class='input'><span class='va'>out1</span> <span class='op'>&lt;-</span> <span class='va'>step1</span><span class='op'>$</span><span class='va'>covars_data</span>
<span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>patientIds</span>, <span class='va'>step1</span><span class='op'>$</span><span class='va'>patientIds</span><span class='op'>)</span> <span class='co'>#should be TRUE</span>
</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'><span class='va'>step2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='get_recurrence_covariates.html'>get_recurrence_covariates</a></span><span class='op'>(</span>df <span class='op'>=</span> <span class='va'>out1</span>,
patientIdVarname <span class='op'>=</span> <span class='st'>"person_id"</span>, eventCodeVarname <span class='op'>=</span> <span class='st'>"event_code"</span>,
patientIdVector <span class='op'>=</span> <span class='va'>patientIds</span><span class='op'>)</span>
<span class='va'>out2</span> <span class='op'>&lt;-</span> <span class='va'>step2</span><span class='op'>$</span><span class='va'>recurrence_data</span>
<span class='va'>out3</span> <span class='op'>&lt;-</span> <span class='fu'>get_prioritised_covariates</span><span class='op'>(</span>df <span class='op'>=</span> <span class='va'>out2</span>,
patientIdVarname <span class='op'>=</span> <span class='st'>"person_id"</span>, exposureVector <span class='op'>=</span> <span class='va'>basetable</span><span class='op'>$</span><span class='va'>treatment</span>,
outcomeVector <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>basetable</span><span class='op'>$</span><span class='va'>outcome_date</span><span class='op'>)</span>, <span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span>,
patientIdVector <span class='op'>=</span> <span class='va'>patientIds</span>, k <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Dennis Robert.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


